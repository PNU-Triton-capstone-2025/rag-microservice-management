<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">

<head>
  <meta charset="UTF-8">
  <title th:text="${history.title}">작업 이력 상세</title>
  <style>
    .llm-response {
      white-space: pre-wrap;
      word-break: break-word;
      background-color: #fdfdfd;
      padding: 16px 18px;
      border-radius: 10px;
      font-family: 'Pretendard', 'Noto Sans KR', sans-serif;
      font-size: 15px;
      line-height: 1.7;
      color: #2c2c2c;
      box-shadow: 0 1px 4px rgba(0,0,0,0.05);
      border: 1px solid #e8e8e8;
    }
  </style>
</head>
<body>
<section layout:fragment="page-content">
  <div class="container-fluid p-4">
    <h2>[[${history.title}]]</h2>
    <p class="text-muted">[[${#temporals.format(history.createdAt, 'yyyy-MM-dd HH:mm')}]]</p>
    <hr>

    <div class="d-flex justify-content-end mb-2">
      <div class="card bg-primary text-white p-2" style="max-width:70%;">
        <p class="mb-0" th:text="${history.userQuery}"></p>
      </div>
    </div>

    <div class="d-flex justify-content-start mb-2">
      <div class="card bg-light p-2" style="max-width:70%;">
        <h6 class="card-title">응답</h6>
        <pre class="llm-response"
             th:utext="${#strings.replace(#strings.replace(history.llmResponse, ' ', '&nbsp;'), '\n', '<br>')}">
                </pre>
      </div>
    </div>

    <a th:href="@{/projects/{projectId}/chat/history(projectId=${project.id})}"
       class="btn btn-secondary mt-3">목록으로</a>
  </div>
</section>
</body>
</html>
